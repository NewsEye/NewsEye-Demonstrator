<%= render 'previous_next_doc' %>

<% @page_title = t('blacklight.search.show.title', :document_title => document_show_html_title, :application_name => application_name).html_safe %>
<% content_for(:head) { render_link_rel_alternates } %>

<div id="document" class="document <%= render_document_class %>" itemscope  itemtype="<%= @document.itemtype %>">
  <div id="doc_<%= @document.id.to_s.parameterize %>">
    <%= render_document_partials @document, blacklight_config.view_config(:show).partials %>
    <%#= PulUvRails::UniversalViewer.script_tag %>
<!--    <div class="viewer-wrapper">-->
<!--      <div class="uv viewer" data-uri="<%#= url_for action: :manifest, controller: 'iiif', locale: nil %>" style="height: 500px;"></div>-->
<!--    </div>-->

    <%= mirador_tag(
            id: 'mirador_view',
            height: '500px',
            position: 'relative',
            display: 'block',
            options: {
                data: [
                    { manifestUri: url_for(only_path: false, action: :manifest, controller: 'iiif', locale: nil), location: "NewsEye"}
                ],
                layout: '1x1',
                mainMenuSettings: {
                    show: false
                },
                windowObjects: [
                    {
                        loadedManifest: url_for(only_path: false, action: :manifest, controller: 'iiif', locale: nil),
                        availableViews: %w(ThumbnailsView ImageView BookView),
                        viewType: 'ImageView',
                        bottomPanel: false
                    }
                ],
                sidePanelOptions: {
                    tocTabAvailable: true,
                    layersTabAvailable: true,
                    searchTabAvailable: true
                },
                sidePanelVisible: false,
                overlay: false,
                # annotationEndpoint: {name: "Local Storage", module: "LocalStorageEndpoint"}
            }
        )%>
  </div>
</div>

<% if @document.respond_to?(:export_as_openurl_ctx_kev) %>
  <!--
       // COinS, for Zotero among others.
       // This document_partial_name(@document) business is not quite right,
       // but has been there for a while.
  -->
  <span class="Z3988" title="<%= @document.export_as_openurl_ctx_kev(document_partial_name(@document)) %>"></span>
<% end %>
